[ @file = "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc"; @line = 1; ]
import Toybox.Application;
[ @file = "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc"; @line = 2; ]
import Toybox.Communications;
[ @file = "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc"; @line = 3; ]
import Toybox.Lang;
[ @file = "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc"; @line = 5; ]
import Toybox.System;
[ @file = "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc"; @line = 6; ]
import Toybox.Time;
[ @file = "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc"; @line = 7; ]
import Toybox.Time.Gregorian;
[ @file = "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc"; @line = 9; ]
class TrainerRoadWorkoutWebReq{
    [ @file = "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc"; @line = 9; ]
    <init> {
    }
    [ @file = "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc"; @line = 9; ]
    static
    <init> {
    }
    [ @file = "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc"; @line = 10; @position = 16; ]
    private
    var _notify as (callback(args as Dictionary or String or Null) as Void);
    [ @file = "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc"; @line = 11; @position = 16; ]
    private
    var _now as String or Null;
    //! Set up the callback to the view
    //! @param handler Callback method for when data is received
    [ @file = "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc"; @line = 15; ]
    public
    function initialize(handler as (callback(args as Dictionary or String or Null) as Void)) as Void {
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_15_96_start:
[ "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc" 16 8 ]
        %tmp.2 = lgetv %handler;
        putv self :_notify %tmp.2;
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_15_96_stop:
    }
    //! Make the web request
    [ @file = "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc"; @line = 20; ]
    public
    function makeRequest(index as Number) as Void {
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_20_57_start:
[ "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc" 21 8 ]
        [ "_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_20_57_start" "_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_20_57_stop" ]
        %options.1 = local;
        %tmp.1 = newd 2;
        %tmp.3 = const :responseType;
        %tmp.4 = getm $.Toybox.Communications;
        %tmp.5 = getv %tmp.4 :HTTP_RESPONSE_CONTENT_TYPE_JSON;
        %tmp.6 = dup %tmp.1;
        %tmp.7 = aputv %tmp.6 %tmp.3 %tmp.5;
        %tmp.9 = const :headers;
        %tmp.10 = newd 1;
        %tmp.11 = "Content-Type";
        %tmp.12 = getm $.Toybox.Communications;
        %tmp.13 = getv %tmp.12 :REQUEST_CONTENT_TYPE_URL_ENCODED;
        %tmp.14 = dup %tmp.10;
        %tmp.15 = aputv %tmp.14 %tmp.11 %tmp.13;
        %tmp.16 = dup %tmp.7;
        %tmp.17 = aputv %tmp.16 %tmp.9 %tmp.15;
        lputv %options.1 %tmp.17;
[ "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc" 28 8 ]
        [ "_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_20_57_start" "_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_20_57_stop" ]
        %today.2 = local;
        %tmp.18 = getm $.Toybox.Time.Gregorian;
        %tmp.19 = getv function %tmp.18 :info;
        %tmp.20 = getm $.Toybox.Time;
        %tmp.21 = getv function %tmp.20 :now;
        %tmp.22 = invoke %tmp.20 %tmp.21();
        %tmp.23 = getv function %tmp.22 :add;
        %tmp.26 = getm $.Toybox.Time;
        %tmp.27 = getv function ? %tmp.26 :Duration;
        %tmp.28 = 3600;
        %tmp.29 = 24;
        %tmp.30 = mul %tmp.28 %tmp.29;
        %tmp.32 = lgetv %index;
        %tmp.33 = mul %tmp.30 %tmp.32;
        %tmp.24 = newc %tmp.27 (%tmp.33);
        %tmp.34 = invoke %tmp.22 %tmp.23(%tmp.24);
        %tmp.35 = getm $.Toybox.Time;
        %tmp.36 = getv %tmp.35 :FORMAT_SHORT;
        %tmp.37 = invoke %tmp.18 %tmp.19(%tmp.34, %tmp.36);
        lputv %today.2 %tmp.37;
[ "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc" 29 8 ]
        [ "_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_20_57_start" "_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_20_57_stop" ]
        %dateString.3 = local;
        %tmp.38 = getm $.Toybox.Lang;
        %tmp.39 = getv function %tmp.38 :format;
        %tmp.40 = "$1$-$2$-$3$";
        %tmp.41 = newa 3;
        %tmp.42 = lgetv %today.2;
        %tmp.43 = getv %tmp.42 :month;
        %tmp.44 = dup %tmp.41;
        %tmp.45 = aputv %tmp.44 0 %tmp.43;
        %tmp.46 = lgetv %today.2;
        %tmp.47 = getv %tmp.46 :day;
        %tmp.48 = dup %tmp.45;
        %tmp.49 = aputv %tmp.48 1 %tmp.47;
        %tmp.50 = lgetv %today.2;
        %tmp.51 = getv %tmp.50 :year;
        %tmp.52 = dup %tmp.49;
        %tmp.53 = aputv %tmp.52 2 %tmp.51;
        %tmp.54 = invoke %tmp.38 %tmp.39(%tmp.40, %tmp.53);
        lputv %dateString.3 %tmp.54;
[ "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc" 38 8 ]
        %tmp.55 = getm $.Toybox.Time.Gregorian;
        %tmp.56 = getv function %tmp.55 :info;
        %tmp.57 = getm $.Toybox.Time;
        %tmp.58 = getv function %tmp.57 :now;
        %tmp.59 = invoke %tmp.57 %tmp.58();
        %tmp.60 = getv function %tmp.59 :add;
        %tmp.63 = getm $.Toybox.Time;
        %tmp.64 = getv function ? %tmp.63 :Duration;
        %tmp.65 = 3600;
        %tmp.66 = 24;
        %tmp.67 = mul %tmp.65 %tmp.66;
        %tmp.69 = lgetv %index;
        %tmp.70 = mul %tmp.67 %tmp.69;
        %tmp.61 = newc %tmp.64 (%tmp.70);
        %tmp.71 = invoke %tmp.59 %tmp.60(%tmp.61);
        %tmp.72 = getm $.Toybox.Time;
        %tmp.73 = getv %tmp.72 :FORMAT_MEDIUM;
        %tmp.74 = invoke %tmp.55 %tmp.56(%tmp.71, %tmp.73);
        lputv %today.2 %tmp.74;
[ "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc" 39 8 ]
        %tmp.75 = getm $.Toybox.Lang;
        %tmp.76 = getv function %tmp.75 :format;
        %tmp.77 = "$1$ $2$/$3$";
        %tmp.78 = newa 3;
        %tmp.79 = lgetv %today.2;
        %tmp.80 = getv %tmp.79 :day_of_week;
        %tmp.81 = dup %tmp.78;
        %tmp.82 = aputv %tmp.81 0 %tmp.80;
        %tmp.83 = lgetv %today.2;
        %tmp.84 = getv %tmp.83 :day;
        %tmp.85 = dup %tmp.82;
        %tmp.86 = aputv %tmp.85 1 %tmp.84;
        %tmp.87 = lgetv %today.2;
        %tmp.88 = getv %tmp.87 :month;
        %tmp.89 = dup %tmp.86;
        %tmp.90 = aputv %tmp.89 2 %tmp.88;
        %tmp.91 = invoke %tmp.75 %tmp.76(%tmp.77, %tmp.90);
        putv self :_now %tmp.91;
[ "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc" 48 8 ]
        [ "_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_20_57_start" "_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_20_57_stop" ]
        %username.4 = local;
        %tmp.93 = getv ? :Properties;
        %tmp.94 = getv function %tmp.93 :getValue;
        %tmp.95 = "username_prop";
        %tmp.96 = invoke %tmp.93 %tmp.94(%tmp.95);
        lputv %username.4 %tmp.96;
[ "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc" 49 8 ]
        %tmp.97 = getm $.Toybox.System;
        %tmp.98 = getv function %tmp.97 :println;
        %tmp.99 = "https://www.trainerroad.com/app/api/calendar/activities/";
        %tmp.101 = lgetv %username.4;
        %tmp.102 = add %tmp.99 %tmp.101;
        %tmp.103 = "?startDate=";
        %tmp.104 = add %tmp.102 %tmp.103;
        %tmp.106 = lgetv %dateString.3;
        %tmp.107 = add %tmp.104 %tmp.106;
        %tmp.108 = "&endDate=";
        %tmp.109 = add %tmp.107 %tmp.108;
        %tmp.111 = lgetv %dateString.3;
        %tmp.112 = add %tmp.109 %tmp.111;
        invoke %tmp.97 %tmp.98(%tmp.112);
[ "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc" 52 8 ]
        %tmp.113 = getm $.Toybox.Communications;
        %tmp.114 = getv function %tmp.113 :makeWebRequest;
        %tmp.115 = "https://www.trainerroad.com/app/api/calendar/activities/";
        %tmp.117 = lgetv %username.4;
        %tmp.118 = add %tmp.115 %tmp.117;
        %tmp.119 = "?startDate=";
        %tmp.120 = add %tmp.118 %tmp.119;
        %tmp.122 = lgetv %dateString.3;
        %tmp.123 = add %tmp.120 %tmp.122;
        %tmp.124 = "&endDate=";
        %tmp.125 = add %tmp.123 %tmp.124;
        %tmp.127 = lgetv %dateString.3;
        %tmp.128 = add %tmp.125 %tmp.127;
        %tmp.129 = newd 0;
        %tmp.131 = lgetv %options.1;
        %tmp.132 = self;
        %tmp.133 = getv function %tmp.132 :method;
        %tmp.135 = const :onReceive;
        %tmp.136 = invoke %tmp.132 %tmp.133(%tmp.135);
        invoke %tmp.113 %tmp.114(%tmp.128, %tmp.129, %tmp.131, %tmp.136);
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_20_57_stop:
    }
    //! Receive the data from the web request
    //! @param responseCode The server response code
    //! @param data Content from a successful request
    [ @file = "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc"; @line = 64; ]
    public
    function onReceive(responseCode as Number, data as Dictionary<String, Object or Null> or String or Null) as Void {
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_64_117_start:
[ "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc" 65 8 ]
        %tmp.2 = lgetv %data;
        %tmp.3 = as %tmp.2 Array<Dictionary<String, Object or Null>>;
        %tmp.4 = getv function %tmp.3 :add;
        %tmp.5 = newd 1;
        %tmp.6 = "Now";
        %tmp.8 = getv ? :_now;
        %tmp.9 = dup %tmp.5;
        %tmp.10 = aputv %tmp.9 %tmp.6 %tmp.8;
        invoke %tmp.3 %tmp.4(%tmp.10);
[ "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc" 66 8 ]
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_66_8_if_stmt:
        %tmp.12 = lgetv %responseCode;
        %tmp.13 = 200;
        %tmp.14 = eq %tmp.12 %tmp.13;
        bf %tmp.14 @_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_66_8_if_false;
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_66_8_if_true:
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_66_33_start:
[ "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc" 67 12 ]
        %tmp.16 = getv ? :_notify;
        %tmp.17 = getv function %tmp.16 :invoke;
        %tmp.19 = lgetv %data;
        invoke %tmp.16 %tmp.17(%tmp.19);
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_66_33_stop:
        goto @_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_66_8_if_end;
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_66_8_if_false:
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_68_15_start:
[ "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc" 69 12 ]
        [ "_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_68_15_start" "_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_68_15_stop" ]
        %response.1 = local;
        %tmp.20 = lgetv %responseCode;
        %tmp.21 = getv function %tmp.20 :toString;
        %tmp.22 = invoke %tmp.20 %tmp.21();
        lputv %response.1 %tmp.22;
[ "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc" 73 12 ]
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_73_12_if_stmt:
        %tmp.23 = lgetv %response.1;
        %tmp.24 = getv function %tmp.23 :equals;
        %tmp.25 = "404";
        %tmp.26 = invoke %tmp.23 %tmp.24(%tmp.25);
        bf %tmp.26 @_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_73_12_if_end;
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_73_12_if_true:
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_73_39_start:
[ "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc" 74 16 ]
        %tmp.27 = "User not set";
        lputv %response.1 %tmp.27;
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_73_39_stop:
        goto @_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_73_12_if_end;
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_73_12_if_end:
[ "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc" 76 12 ]
        %tmp.28 = getm $.Toybox.System;
        %tmp.29 = getv function %tmp.28 :println;
        %tmp.30 = "Error ";
        %tmp.32 = lgetv %response.1;
        %tmp.33 = add %tmp.30 %tmp.32;
        invoke %tmp.28 %tmp.29(%tmp.33);
[ "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc" 77 12 ]
        %tmp.35 = getv ? :_notify;
        %tmp.36 = getv function %tmp.35 :invoke;
        %tmp.37 = newd 1;
        %tmp.38 = "Error";
        %tmp.39 = "Err: ";
        %tmp.41 = lgetv %response.1;
        %tmp.42 = add %tmp.39 %tmp.41;
        %tmp.43 = dup %tmp.37;
        %tmp.44 = aputv %tmp.43 %tmp.38 %tmp.42;
        invoke %tmp.35 %tmp.36(%tmp.44);
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_68_15_stop:
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_66_8_if_end:
_Users_jhartman_Downloads_Garmin_ConnectIQ_TrainerRoadWorkout_source_TrainerRoadWorkoutWebReq_mc_64_117_stop:
    }
}
[ @file = "/Users/jhartman/Downloads/Garmin ConnectIQ/TrainerRoadWorkout/source/TrainerRoadWorkoutWebReq.mc"; @line = 1; ]
<init> {
}
